/*
ƒê·ªí √ÅN M√îN H·ªåC AN TO√ÄN B·∫¢O M·∫¨T D·ªÆ LI·ªÜU TRONG H·ªÜ TH·ªêNG TH√îNG TIN
FILE T·∫†O DATABASE 
NH√ìM 9
MSSV        H·ªå T√äN          
19127366    Long M·ªπ Du
19127377    Nguy·ªÖn Hu·ª≥nh Kh√°nh Duy
19127476    Tr·∫ßn Th·ªã Hu·∫ø Minh
*/

-- T·∫°o b·∫£ng
CREATE TABLE HSBA (
    MAHSBA CHAR(8),
    MABN CHAR(8),
    NGAY DATE,
    CHANDOAN NVARCHAR2(100),
    MABS CHAR(6),
    MAKHOA CHAR(6),
    MACSYT CHAR(6),
    KETLUAN NVARCHAR2(200),
	CONSTRAINT HSBA_PK PRIMARY KEY ( MAHSBA )
);

CREATE TABLE HSBA_DV (
    MAHSBA CHAR(8),
    MADV CHAR(6),
    NGAY DATE,
    MAKTV CHAR(6),
    KETQUA NVARCHAR2(200),
	CONSTRAINT HSBA_DV_PK PRIMARY KEY ( MAHSBA, MADV, NGAY )
);


CREATE TABLE BENHNHAN (
	MABN CHAR(8),
	MACSYT CHAR(6),
	TENBN NVARCHAR2(50),
	CMND CHAR(64),
	NGAYSINH DATE,
	SONHA VARCHAR2(20),
	TENDUONG NVARCHAR2(100),
	QUANHUYEN NVARCHAR2(50),
	TINHTP NVARCHAR2(50),
	TIENSUBENH NVARCHAR2(200),
	TIENSUBENHGD NVARCHAR2(200),
	DIUNGTHUOC NVARCHAR2(200),
	CONSTRAINT BENHNHAN_PK PRIMARY KEY ( MABN )

);

CREATE TABLE CSYT(
	MACSYT CHAR(6),
	TENCSYT NVARCHAR2(200),
	DCCSYT NVARCHAR2(200),
	SDTCSYT CHAR(10),
	CONSTRAINT CSYT_PK PRIMARY KEY ( MACSYT )
);

CREATE TABLE NHANVIEN(
	MANV CHAR(6),
	HOTEN NVARCHAR2(50),
	PHAI NVARCHAR2(5),
	NGAYSINH DATE,
	CMND CHAR(64),
	QUEQUAN NVARCHAR2(50),
	SODT CHAR(10),
	CSYT CHAR(6),
	VAITRO NVARCHAR2(20),
	CHUYENKHOA NVARCHAR2(20),
	CONSTRAINT NHANVIEN_PK PRIMARY KEY ( MANV )
);
/

CREATE TABLE CHUYENKHOA(
    MAKHOA CHAR(6),
    TENKHOA NVARCHAR2(20),
    CONSTRAINT CHUYENKHOA_PK PRIMARY KEY ( MAKHOA )
);

CREATE TABLE DICHVU(
    MADV CHAR(6),
    TENDICHVU NVARCHAR2(30),
    CONSTRAINT DICHVU_PK PRIMARY KEY ( MADV)
);

-- T·∫°o c√°c Foreign key constraints v√† check constraints
ALTER TABLE HSBA
ADD CONSTRAINT HSBA_BENHNHAN_FK FOREIGN KEY ( MABN )
        REFERENCES BENHNHAN ( MABN )
        ON DELETE CASCADE;
ALTER TABLE HSBA
ADD CONSTRAINT HSBA_NHANVIEN_FK FOREIGN KEY ( MABS )
        REFERENCES NHANVIEN ( MANV )
        ON DELETE CASCADE;

ALTER TABLE HSBA
ADD CONSTRAINT HSBA_CSYT_FK FOREIGN KEY ( MACSYT )
        REFERENCES CSYT ( MACSYT);

ALTER TABLE HSBA
ADD CONSTRAINT HSBA_CHUYENKHOA_FK FOREIGN KEY ( MAKHOA )
        REFERENCES CHUYENKHOA ( MAKHOA );
        
ALTER TABLE HSBA_DV
ADD CONSTRAINT HSBA_DV_HSBA_FK FOREIGN KEY ( MAHSBA )
        REFERENCES HSBA ( MAHSBA )
        ON DELETE CASCADE;

ALTER TABLE HSBA_DV
ADD CONSTRAINT HSBA_DV_DICHVU_FK FOREIGN KEY ( MADV )
        REFERENCES DICHVU ( MADV );
        
ALTER TABLE BENHNHAN
ADD CONSTRAINT BENHNHAN_CSYT_FK FOREIGN KEY ( MACSYT )
        REFERENCES CSYT ( MACSYT);

ALTER TABLE NHANVIEN
ADD CONSTRAINT NHANVIEN_CSYT_FK FOREIGN KEY ( CSYT )
        REFERENCES CSYT ( MACSYT);

ALTER TABLE NHANVIEN
ADD CONSTRAINT NHANVIEN_VAITRO_FK 
<<<<<<< Updated upstream
	CHECK (VAITRO IN (N'Thanh tra', N'C∆° s·ªü y t·∫ø', N'Y sƒ©/ b√°c sƒ©', N'Nghi√™n c·ª©u',N'Gi√°m ƒë·ªëc s·ªü',N'Gi√°m ƒë·ªëc CSYT TT',N'Gi√°m ƒë·ªëc CSYT CTT',N'Gi√°m ƒë·ªëc CSYT NT'));
/
=======
	CHECK (VAITRO IN (N'Thanh tra', N'C∆° s·ªü y t·∫ø', N'Y sƒ©/b√°c sƒ©', N'Nghi√™n c·ª©u'));



-- INSERT DATA TO NHANVIEN
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0001',N'B?nh vi?n ?a khoa V?n H?nh',N'700 S? V?n H?nh (n?i d‡i) - P 12 ñ Qu?n 10 - TP.HCM', '0986875637');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0002',N'B?nh vi?n T‚n S?n Nh?t',N'2B Ph? Quang - P2 - Qu?n T‚n BÏnh - TP.HCM', '0902318877');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0003',N'B?nh vi?n ?a khoa T‚n H?ng ',N'871 Tr?n Xu‚n So?n - P. T‚n H?ng - Qu?n 7 - TP.HCM', '0913777399');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0004',N'B?nh vi?n Th?ng Nh?t',N'01 L˝ Th??ng Ki?t ñ Ph??ng 7 - Qu?n T‚n BÏnh - TP.HCM', '0966821010');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0005',N'B?nh vi?n 175',N'786 Nguy?n Ki?m- P. 3- Qu?n GÚ v?p - TP.HCM', '0984795351');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0006',N'B?nh vi?n Nguy?n Tri Ph??ng',N'468 Nguy?n Tr„i ñ Ph??ng 8 ñ Qu?n 5 - TP.HCM', '0931427504');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0007',N'B?nh vi?n Nh‚n d‚n Gia ??nh',N'01 N? Trang Long ñ Ph??ng 7 ñ Qu?n BÏnh Th?nh - TP.HCM', '0902418869');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0008',N'B?nh vi?n nh‚n d‚n 115',N'527 S? V?n H?nh ñ Ph??ng 12 ñ Qu?n 10 - TP.HCM', '0907527643');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0009',N'B?nh vi?n ?a khoa S‡i GÚn',N'125 LÍ L?i ñ Ph??ng B?n Th‡nh ñ Qu?n 1 - TP.HCM', '0902963115');
INSERT INTO CSYT(MACSYT, TENCSYT, DCCSYT, SDTCSYT) VALUES ('CS0010',N'B?nh vi?n Qu‚n D‚n Mi?n ?Ùng ',N'50 LÍ V?n Vi?t ñ Ph??ng Hi?p Ph˙ - Qu?n 9 - TP.HCM', '0908376664');

INSERT INTO NHANVIEN (MANV, HOTEN, PHAI, SODT, NGAYSINH, QUEQUAN, CMND, CSYT, VAITRO, CHUYENKHOA)
VALUES('NV0001',N'Nguy?n Vi?t Duy', N'Nam', '0901525162', '1925-09-05', N'398 Nguy?n Th? L?u, Q.10, TP.HCM ', '721139552897', 'CS0002', N'Thanh tra', N'Ung th?');


SELECT * FROM CSYT



>>>>>>> Stashed changes

-- T·∫°o ROLE BENHNHAN
CREATE ROLE ROLE_BENHNHAN NOT IDENTIFIED;
SET ROLE ROLE_BENHNHAN;
GRANT CREATE SESSION TO ROLE_BENHNHAN;
/
-- T·∫°o ROLE NHANVIEN
CREATE ROLE ROLE_NHANVIEN NOT IDENTIFIED;
SET ROLE ROLE_NHANVIEN;
GRANT CREATE SESSION TO ROLE_NHANVIEN;
/
-- T·∫°o ROLE YBACSI
CREATE ROLE ROLE_YBACSI;
SET ROLE ROLE_YBACSI;
GRANT CREATE SESSION TO ROLE_YBACSI;
/
-- T·∫°o ROLE_THANHTRA
CREATE ROLE ROLE_THANHTRA;
SET ROLE ROLE_THANHTRA;
GRANT CREATE SESSION TO ROLE_THANHTRA;
/
--T·∫°o ROLE_QUANLY
CREATE ROLE ROLE_CSYT;
SET ROLE ROLE_CSYT;
GRANT CREATE SESSION TO ROLE_CSYT;
/
--T·∫°o ROLE_NGHIENCUU
CREATE ROLE ROLE_NGHIENCUU;
SET ROLE ROLE_NGHIENCUU;
GRANT CREATE SESSION TO ROLE_NGHIENCUU;
